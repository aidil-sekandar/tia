{{- define "main" -}}
    {{ partial "nav.html" (dict "nav_white" 1) }}
    {{ $guideline := .Site.Data.guideline }}


    <section style="padding-top: 6.5rem" class="mb-5">
        <div class="container">
            <div class="d-flex row justify-content-between align-items-center">
                <!-- Left Image -->
                <div
                    class="col-md-2 text-center d-none d-md-block ms-1 me-0 mb-0 px-0 py-0"
                    style="width: 15%"
                >
                    <img
                        style="max-width: 100%;"
                        src="{{ absURL "guideline/side-img-1.png" }}"
                    />
                </div>
                <!-- Center Content -->
                <div class="col-md-8">
                    <h2 class="text-center text-primary fw-lighter">
                        Know each <span class="fw-bold">department</span>
                    </h2>
                    <p class="text-center">
                        Find out more about the mission and general tasks of
                        each department.
                    </p>
                </div>
                <!-- Right Image -->
                <div
                    class="col-md-2 text-center d-none d-md-block me-1 px-3"
                    style="width: 15%"
                >
                    <img
                        style="max-width: 100%;"
                        src="{{ absURL "guideline/side-img-2.png" }}"
                    />
                </div>
            </div>
        </div>
    </section>

    <!--list of departments-->
    <section class="bg-body-secondary mb-5">
        <div class="container mt-2 py-5">
            <!-- Executive Director row -->
            <div class="row justify-content-center">
                <div class="col-12 col-md-4 mb-3">
                    <div
                        style="border-radius: 20px;"
                        class="col bg-secondary py-3 px-3 d-flex align-items-center justify-content-center"
                    >
                        <p class="text-primary" style="font-weight: 600">
                            Executive Director
                        </p>
                    </div>
                </div>
                <div class="col-12 col-md-4 mb-3">
                    <div
                        style="border-radius: 20px;"
                        class="col bg-secondary py-3 px-3 d-flex align-items-center justify-content-center"
                    >
                        <p class="text-primary" style="font-weight: 600">
                            Secretarial Director
                        </p>
                    </div>
                </div>
            </div>

            <!-- Department rows -->
            <div class="row justify-content-center g-3">
                {{ range $index, $element := $guideline }}
                    {{ if gt $index 1 }}
                        <div class="col-md-4">
                            <div
                                style="border-radius: 20px;"
                                class="col bg-secondary py-3 px-3 d-flex align-items-center justify-content-center"
                            >
                                <p
                                    class="text-center mb-0 text-primary"
                                    style="font-weight: 600;"
                                >
                                    {{ .department }}
                                </p>
                            </div>
                        </div>
                    {{ end }}
                {{ end }}
            </div>
        </div>
    </section>

    <!--info of each departments-->
    <section class="container mb-5">
        <div class="py-5 row g-3 justify-content-center">
            {{ range $guideline }}
                <div class="col-md-6">
                    <div
                        class="bg-body-secondary mb-2 border-0 px-4 py-3"
                        style="border-radius: 15px"
                    >
                        <!--image-->
                        <div class="d-flex justify-content-center mb-3">
                            <img
                                src="{{ absURL .icon }}"
                                alt="{{ .department }} Icon"
                                class="img-fluid"
                            />
                        </div>

                        <!--dropdown button-->
                        <div class="dropdown d-block text-center">
                            <button
                                style="border-radius: 10px; width: 100%"
                                class="dropdown-toggle py-2 px-3 text-primary border-0 fw-bold text-wrap"
                                type="button"
                                data-bs-toggle="dropdown"
                                data-bs-display="static"
                                aria-expanded="false"
                            >
                                {{ .department }}
                            </button>
                            <!--dropdown menu (mission & general tasks)-->
                            <div
                                class="dropdown-menu mt-2 bg-secondary px-3 pt-3"
                                style="border-radius: 20px; border: none;"
                            >
                                <div>
                                    <span class="text-primary fw-bold"
                                        >Mission</span
                                    >
                                    <ul>
                                        {{ range .mission }}
                                            <li
                                                class="px-2 justify-content-center"
                                                class="text-primary"
                                            >
                                                {{ . }}
                                            </li>
                                        {{ end }}
                                    </ul>
                                </div>
                                <div>
                                    <span class="text-primary fw-bold"
                                        >General Task</span
                                    >
                                    <ul>
                                        {{ range .generalTask }}
                                            <li
                                                class="px-2 justify-content-center"
                                            >
                                                {{ . }}
                                            </li>
                                        {{ end }}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {{ end }}
        </div>
    </section>

    <section class="bg-body-secondary">
        <div class="container" style="padding: 4em 1em;">
            <div class="text-center" style="padding: 0 1em 4em 1em;">
                <h2 class="fw-bold text-primary" style="font-size: 3rem;">Join us!</h2>
                <p style="font-weight: 500; font-size: 1.1rem;">
                    Together, we can make a meaningful impact.
                </p>
            </div>
            <div class="slider">
                <div class="slider-inner">
                    <div class="slider-item">
                        <div
                            class="box"
                            style='--bg: url("{{ absURL "guideline/joinus.jpg" }}");'
                        ></div>
                    </div>
                    <div class="slider-item">
                        <div
                            class="box"
                            style='--bg: url("{{ absURL "guideline/joinus-2.jpg" }}");'
                        ></div>
                    </div>
                    <div class="slider-item">
                        <div
                            class="box"
                            style='--bg: url("{{ absURL "guideline/joinus-3.jpg" }}");'
                        ></div>
                    </div>
                    <div class="slider-item">
                        <div
                            class="box"
                            style='--bg: url("{{ absURL "guideline/joinus-4.jpg" }}");'
                        ></div>
                    </div>
                </div>
                <div class="control">
                    <button id="prev"><span>&ltrif;</span></button>
                    <button id="next"><span>&rtrif;</span></button>
                </div>
            </div>
        </div>
    </section>

    {{ partial "footer.html" }}

    {{/* Reference to external css files */}}
    {{ with resources.Get "guideline.css" | postCSS | minify }}
        <link rel="stylesheet" href="{{ .Permalink }}" />
    {{ end }}


    <script>
        // Javascript is used to modify the dropdown's default behavior
        //  -> Default: Bootstrap's dropdown will open downward, but it will open upward if there is not enough space at the bottom.
        //     Modify: Dropdown menu only opens downward, even if there is not enough space at the bottom
        //  -> Default: Bootstrap's dropdown collapses when an item inside the menu is clicked.
        //     Modify: Dropdown only collapses when clicking outside of it.

        $(document).ready(function () {
            // Prevent the dropdown from closing when clicking inside it
            $(".dropdown-menu").on("click", function (event) {
                event.stopPropagation();
            });

            // Close the dropdown when clicking outside of it
            $(document).on("click", function (event) {
                let target = $(event.target);
                if (!target.closest(".dropdown, .dropdown-toggle").length) {
                    $(".dropdown-menu").removeClass("show");
                }
            });

            // Open the dropdown when clicking the button
            $("#dropdownMenuButton").on("click", function (event) {
                let dropdownMenu = $(this).next(".dropdown-menu");
                dropdownMenu.toggleClass("show");
            });
        });

        // Image carousel 

        var $ = document;

        $.addEventListener("DOMContentLoaded", function () {
            const sliderMe = () => {
                let currentPosition = 0,
                    sliderItem = document.querySelectorAll(".slider-item"),
                    sliderItemWidth = window
                        .getComputedStyle(sliderItem[0])
                        .flexBasis.match(/\d+\.?\d+/g),
                    sliderInner = $.querySelector(".slider-inner"),
                    control = {
                        next: $.querySelector("#next"),
                        slideNext() {
                            currentPosition += parseFloat(sliderItemWidth);
                            if (currentPosition > limitPosition) {
                                currentPosition = 0;
                            }
                            sliderInner.style.right = currentPosition + "%";
                        },
                        prev: $.querySelector("#prev"),
                        slidePrev() {
                            currentPosition -= parseFloat(sliderItemWidth);
                            if (currentPosition < 0) {
                                currentPosition = limitPosition;
                            }
                            sliderInner.style.right = currentPosition + "%";
                        },
                    },
                    limitPosition =
                        sliderItemWidth *
                        (sliderItem.length - Math.floor(100 / sliderItemWidth));

                control.next.addEventListener("click", control.slideNext);
                control.prev.addEventListener("click", control.slidePrev);

                window.addEventListener("resize", function () {
                    currentPosition = 0;
                    $.querySelector(".slider-inner").style.right =
                        currentPosition + "%";
                });
            };
            sliderMe();

            window.addEventListener("resize", sliderMe);
        });
    </script>
{{- end -}}
